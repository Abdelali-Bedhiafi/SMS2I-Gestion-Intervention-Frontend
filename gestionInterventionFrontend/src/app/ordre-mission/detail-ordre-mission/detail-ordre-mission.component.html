<mat-card class="ordre" *ngIf="ready">
  <mat-card-header>
    <mat-card-title>Ordre Mission: {{ordreMission.id}} </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <mat-grid-list cols="4" rowHeight="10:6" gutterSize="5px">
      <mat-grid-tile>
          <mat-grid-tile-header>Client</mat-grid-tile-header>
            {{ordreMission.client.nom}}
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-grid-tile-header>Etat</mat-grid-tile-header>
            {{ordreMission.etat}}
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-grid-tile-header>Superviseur</mat-grid-tile-header>
        {{ordreMission.superviseur.nom+" "+ordreMission.superviseur.prenom}}
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-grid-tile-header>Date demande</mat-grid-tile-header>
        {{ordreMission.dateMission|date:"d MMM, y" }}
      </mat-grid-tile>
    </mat-grid-list>
    <mat-grid-list cols="4" rowHeight="10:6" gutterSize="5px">
      <form>
        <mat-grid-tile>
          <mat-grid-tile-header>Date debut estimee</mat-grid-tile-header>
          {{ordreMission.dateDebutEstime|date:"d MMM, y"}}
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-grid-tile-header>Duree estimee</mat-grid-tile-header>
          {{ordreMission.dureeEstime+" h"}}
        </mat-grid-tile>
      </form>
    </mat-grid-list>

    <br>
    <button mat-stroked-button *ngIf="ordreMission.checklist == null; else checklist " (click)="selectChecklistModel()" >
      select checklist <mat-icon >add_circle</mat-icon>
    </button>
    <ng-template #checklist >
      <button mat-stroked-button [routerLink]="'/checkListDetail/'+this.ordreMission.checklist.id" >
        CheckList : {{this.ordreMission.checklist.model.nom}}
      </button>
    </ng-template>
    <br>
    <mat-card>
      <mat-card-header>
        <mat-icon>info</mat-icon>
        <mat-card-title> Info</mat-card-title>
        <span class="spacer"></span>
        <button mat-stroked-button >
          <mat-icon>check_circle</mat-icon>
        </button>
      </mat-card-header>
      <mat-card-content>
        <form>
          <mat-form-field class="texteArea"  appearance="fill">
            <mat-label>Description Mission</mat-label>
            <textarea matInput ></textarea>
          </mat-form-field>
          <mat-form-field class="texteArea"   appearance="fill">
            <mat-label>Reclamation Client</mat-label>
            <textarea matInput ></textarea>
          </mat-form-field>
        </form>
      </mat-card-content>
    </mat-card>
    <mat-card>
      <mat-card-header>
        <mat-card-title>Objet Mission</mat-card-title>
        <span class="spacer"></span>
        <button mat-stroked-button [disabled]="!objetChanges" (click)="submitObjetChanges()">
          <mat-icon>check_circle</mat-icon>
        </button>
      </mat-card-header>
      <mat-card-content>
        <mat-grid-list cols="3" rowHeight="10:6" gutterSize="5px">
          <mat-grid-tile>
            <mat-form-field >
              <input matInput type="text" placeholder="actions"
                     [matAutocomplete]="autoAction"
                     [formControl]="actionSelectControl">
            </mat-form-field>
            <mat-autocomplete #autoAction="matAutocomplete" [displayWith]="displayFn">
              <mat-option *ngFor="let action of filteredActions | async">
                <div (click)="optionClicked($event, action)">
                  <mat-checkbox [checked]="action.selected"
                                (change)="toggleSelection(action)"
                                (click)="$event.stopPropagation()"
                                [color]="action.color">
                    {{ action.sousCategorie.titre }}
                  </mat-checkbox>
                </div>
              </mat-option>
            </mat-autocomplete>
          </mat-grid-tile>
          <mat-grid-tile>
            <mat-form-field >
              <input matInput type="text" placeholder="reseaux"
                     [matAutocomplete]="autoReseau"
                     [formControl]="reseauSelectControl">
            </mat-form-field>
            <mat-autocomplete #autoReseau="matAutocomplete" [displayWith]="displayFn">
              <mat-option *ngFor="let reseau of filteredReseaux | async">
                <div>
                  <mat-checkbox [checked]="reseau.selected"
                                (change)="toggleSelection(reseau)"
                                (click)="$event.stopPropagation()"
                                [color]="reseau.color">
                    {{ reseau.sousCategorie.titre }}
                  </mat-checkbox>
                </div>
              </mat-option>
            </mat-autocomplete>
          </mat-grid-tile>
          <mat-grid-tile>
            <mat-form-field >
              <input matInput type="text" placeholder="technologies"
                     [matAutocomplete]="autoTechnologie"
                     [formControl]="technologieSelectControl">
            </mat-form-field>
            <mat-autocomplete #autoTechnologie="matAutocomplete" [displayWith]="displayFn">
              <mat-option *ngFor="let technologie of filteredTechnologies | async">
                <div>
                  <mat-checkbox [checked]="technologie.selected"
                                (change)="toggleSelection(technologie)"
                                (click)="$event.stopPropagation()"
                                [color]="technologie.color">
                    {{ technologie.sousCategorie.titre }}
                  </mat-checkbox>
                </div>
              </mat-option>
            </mat-autocomplete>
          </mat-grid-tile>
        </mat-grid-list>
      </mat-card-content>
    </mat-card>



    <mat-card>
      <mat-card-header>
        <mat-card-title>Techniciens</mat-card-title>
        <span class="spacer"></span>
        <button mat-stroked-button add-course-btn (click)="affecterTechnicien()"> <mat-icon>add_circle</mat-icon></button>
      </mat-card-header>
      <mat-card-content>
        <mat-grid-list cols="4" rowHeight="10:6" gutterSize="5px" >
          <mat-grid-tile *ngFor="let technicien  of ordreMission.techniciens">
            <mat-grid-tile-header>
              {{technicien.nom+" "+technicien.prenom}}
            </mat-grid-tile-header>
          </mat-grid-tile>
        </mat-grid-list>
      </mat-card-content>
    </mat-card>
    <mat-card>
      <mat-card-header>
        <mat-card-title>Deplacement</mat-card-title>
        <span class="spacer"></span>
        <button mat-stroked-button (click)="ajouterDeplacement()"> <mat-icon>add_circle</mat-icon></button>
      </mat-card-header>
      <mat-card-content>
        <mat-grid-list cols="4" rowHeight="10:6" gutterSize="5px" >
          <mat-grid-tile *ngFor="let deplacement  of ordreMission.deplacements">
            <mat-grid-tile-header>
              {{deplacement.date | date}}
              <span class="spacer"></span>
              <button mat-stroked-button (click)="editDeplacement(deplacement)" >
                <mat-icon>edit</mat-icon>
              </button>
            </mat-grid-tile-header>

              {{timeFormat(deplacement.heureDebut)}} ->
              {{timeFormat(deplacement.heureFin)}}
            <mat-grid-tile-footer>
              <span class="spacer"></span>
              <button mat-stroked-button [routerLink]="'/depense/'+deplacement.id" >
                <mat-icon>paid</mat-icon>
              </button>
            </mat-grid-tile-footer>
          </mat-grid-tile>
        </mat-grid-list>
      </mat-card-content>
    </mat-card>
  <mat-card>
    <mat-card-header>
      <mat-card-title>Accompte</mat-card-title>
      <span class="spacer"></span>
      <button mat-stroked-button (click)="submitAccompteChanges()" [disabled]="!accompteChanges"> <mat-icon>check_circle</mat-icon></button>
    </mat-card-header>
    <mat-card-content>
      <mat-grid-list cols="4" rowHeight="2:1" gutterSize="5px">
        <mat-grid-tile>
          <mat-form-field (focusout)="changeMax()"  >
            <mat-label>accompte</mat-label>
            <input type="number" matInput [formControl]="accompteControl" >
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile>
          <mat-form-field >
            <mat-label>retour</mat-label>
            <input type="number" matInput [formControl]="retourControl" >
          </mat-form-field>
        </mat-grid-tile>
      </mat-grid-list>
    </mat-card-content>
  </mat-card>
</mat-card-content>

</mat-card>


